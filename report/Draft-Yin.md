# FMA数据集的修正

在使用数据集前，发现数据集内有部分音乐片段损坏，且在数据集自带的metadata数据中也同样数据异常。如直接使用可能会影响实验结果。

在找出损坏音乐片段后，使用同长度同风格音乐片段替换损坏文件，重新进行特征提取等工作。

# 音频特征提取 —— MFCC

MFCC(Mel-Frequency Cepstral Coefficients)是一种在机器学习中广泛应用于音频信号处理的特征表示方法。

在计算MFCC的过程中，首先分帧加窗，再对每个窗口的信号进行傅里叶变换，将时域信号转换为频域信号。并由梅尔滤波器组将频谱分成一系列频带，模拟人类听觉系统对声音的感知。通过对每个频带的能量取对数，可以模拟人耳对音强的非线性感知。最后进行离散余弦变换，得到最终的MFCC系数。

每个MFCC系数被表示为向量，捕捉音频信号在梅尔频率轴上的特征。每个MFCC系数对应于梅尔滤波器组中的一个频带，反映了音频信号在不同频率范围内的分布。在本次实验中，通过Librosa库提供的函数能够方便地获取MFCC系数。设置音频采样率为22500，并提取24个MFCC系数以充分捕捉音频的特征。

# 音频特征提取 —— Onset Strength

Grosche, Peter, Meinard Müller, and Frank Kurth. “Cyclic tempogram - A mid-level tempo representation for music signals.” ICASSP, 2010.

Grosche, Peter, Meinard Müller, 和 Frank Kurth 在 2010 年的 ICASSP 中提出的一项研究，介绍一种适用于音乐信号的中级节奏表示方法。

起始强度包络的局部自相关性是指音频信号中与信号开始瞬间相关的强度变化的包络。在音频处理中，此类瞬间通常与信号中的音符、击打或其他重要事件相关联。起始强度包络捕捉了这些事件在时间上的强度变化。局部自相关性则指对起始强度包络的某个局部区域进行自相关性计算。分析此类时间序列，可以帮助理解音频信号中的重复模式、节奏或其他结构性特征。

Librosa库也提供相关的函数能够方便地获取这一特征。设置音频采样率为22500，并设置处理窗口为24以尽可能保留特征信息。

# 特征提取后的预处理

特征提取后获得的数据不能够直接用于分类任务，需要首先将数据进行一定的预处理，转换为各种统计量。本实验采取对每个音频片段的每个特征量，通过Numpy库函数，获取其最小值、最大值、平均值、标准差、中位数、峰度、偏度、变异系数和绝对偏差等9个统计值。其中，偏度描述数据分布的偏斜程度，峰度描述数据分布的尖峭或平缓程度。变异系数用于比较不同特征的相对离散程度，绝对偏差和标准差共同用于描述数据的散布情况。

# 输入数据

输入数据为每个音频片段的每个特征量，经过预处理后的统计量 X ,和音频片段对应的音频流派 Genre 。

设置训练集和测试集的比例为0.8:0.2。

并对数据进行归一化处理。通过数据归一化处理，避免特征尺度差异导致的泛化能力下降，同时提高模型收敛速度，也避免异常值对模型的影响，使模型更加健壮。

# 网格搜索 Grid Search

网格搜索是一种用于调优机器学习模型参数的技术，适用于本次实验中使用的逻辑回归和支持向量机等算法。在机器学习中，模型的性能很大程度上取决于所选择的超参数，而网格搜索通过系统地搜索指定的参数空间，找到找到在给定数据集上表现最佳的超参数组合，从而提高模型的准确性和泛化能力

在逻辑回归模型中，网格搜索用于调整正则化参数、最大迭代次数等超参数。而在SVC中，网格搜索用于调整核函数的相关参数、惩罚系数等，从而提高模型对于复杂数据的分类性能。

# 实验结论

## 特征工程的重要性

特征工程是指通过选择、构建、转换数据中的特征，以改进机器学习模型的性能的过程。本次实验中，选择合适的特征比选择算法和其超参数，对模型效果的提升更为明显。

使用仅MFCC特征训练的模型，性能较使用仅Onset Strength特征训练的模型提升近20%。同时使用以上2个特征训练的模型，性能提升并不明显，较同算法训练模型提升仅3%。

这说明在该音频分类任务中，频谱信息对于模型性能的贡献更为显著。以上2个特征在信息上有一定冗余但并不完全互补。可能存在某种特定的特征组合方式，或者这两个特征的权衡，能够更好地提升模型性能。

## 模型类型对特定分类识别有明显影响

本次实验中，使用支持向量机算法训练的模型，对Electronic、Instrumental、International等流派分类效果更好，较逻辑回归算法提升平均近18%。但使用逻辑回归算法训练的模型，对Hip-Hop、Rock等流派分类效果更高，较支持向量机算法训练提升平均近15%。

流派之间的音频特性和模式可能差异较大。支持向量机和逻辑回归在处理非线性和线性关系上的表现不同，因此对于不同的流派，不同的算法可能有更好的适应性。这强调了在选择算法时需要考虑任务特点和数据特性。

## Pop流派分类效果普遍较差

可能与Pop流派与其他流派近似度较高有关。

## 集成投票策略在弱分类器精度不高时使用效果不佳

通过对训练的各弱分类器采取软投票方式集成后，得出的模型并未有较高的性能提升。在本次实验中，弱分类器的性能不高是显而易见的原因。由于弱分类器的准确性不足，集成模型的性能可能无法显著超越单个弱分类器。并且集成中的弱分类器之间存在较高的相关性，此时投票策略可能无法有效地纠正错误。整体性能难以提升。
